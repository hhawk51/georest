### Using and Configuring HTML Templates ###

In this document configuration of the restcfg.xml and template files for HTML representation is shown.

To enable HTML of the resource an representation **Representation** element with syntax bellow must be added in the restcfg.xml file.

Representation element Syntax:
```
<Representation renderer="Template" pattern=".html" mimetype="text/html" >
   <Templates section="<section name>" prefix="<prefix name>">
     <Many file="<file name>" />
     <Single file="<file name>" />
     <None file="<file name>" />
     <Error file="<file name>" />
   </Templates>
   <Method name="GET"/>
</Representation>
```

Description of the elements from configuration syntax above
| **Element** |
|:------------|
| [Representation](#Representation_element.md) |
| [Method](#Method_element.md) |
| [Templates](#Templates_element.md) |
| [Many](#Many_element.md) |
| [Single](#Single_element.md) |
| [None](#None_element.md) |
| [Error](#Error_element.md) |
| [AdditionalData](#AdditionalData_element.md) |


## Representation element ##

To configure GeoREST to render template files as HTML add **Representation element** to the restcfg.xml file.
Set the **renderer** attribute of this element to value **"Template"**, **pattern** attribute to value **".html"** and **mimetype** attribute to value **"text/html"**.
Details about configuring are found in [Configuration](Configuration.md) part of documentation.
In the example bellow it is shown common configuration from georest.xml file for **Resource** representation as HTML response.
Renderer attribute value is **Template**, **pattern** attribute is ".html" and **mimetype** attribute is "text/html".

Example:
```
 <Representation renderer="Template" pattern=".html" mimetype="text/html" >
 </Representation>
```

> To configure GeoREST to render template file as another response, change **pattern** and **mimetype** attribute to appropriate values.
For example to render as KML set **pattern** attribute to ".kml" and **mimetype** to value "application/vnd.google-earth.kml+xml". Look at [Configuration](Configuration.md) and at
[Configuring KML Templates](RenderersTemplateKml.md).

Before we can configure HTML template files child element described bellow of the **Representation element** must be configured.

> ### Method element ###
> A Method element defines the allowed HTTP method for Representation. For HTML templates usually we allow only **GET** method.

Example: Allow GET method
```
     <Representation renderer="Template" pattern=".html" mimetype="text/html" >
      <Method name="GET" />
     </Representation>
```

> ### Templates element ###
> To configure the **Templates element** two attribute values must be set. The **section attribute** value and the **prefix attribute** value. Look at [Section and Prefix](RenderersTemplate#Section_and_Prefix.md).
The **section** and **prefix** attributes define the section name and property prefix names to be used in the templates file.
To mark the **Section** enclose section name as `{{#section name}}` and to mark the section end enclose the section name as `{{/section name}}`.

Example:
section and prefix of **Templates element** definition from restfg.xml
```
     <Representation renderer="Template" pattern=".html" mimetype="text/html" >
       <Templates section="PROPERTY" prefix="PROPERTY_">
       </Templates>
       <Method name="GET" />
     </Representation>
```

Section and prefix names used in HTML template. Section starts with enclosed section name name `{{#PROPERTY}}` and section ends with `{{/PROPERTY}}`.
To render property name RPROPAD use prefix PROPERTY before property name enclosed with double curly brackets : `{{PROPERTY_RPROPAD}}`.
```
    <html>
     <head>
     </head>
      <body>    
       {{#PROPERTY}}
        {{PROPERTY_RPROPAD}}
       {{/PROPERTY}}
     </body>
    </html>
```
**NOTE! The above example will not work because additional Templates element child elements must be defined.**

  * Child elements of the Templates element
> > #### Many element ####
> > In the **Many element** the name of the file is defined to be used for "query" with "many" results. The filename is defined with the **file** attribute of the the **Many element**.
Examples:
      * Many element configuration in restcfg.xml. File to be used for queries with "many" result is "property\_html\_many.tpl".
```
<Representation renderer="Template" pattern=".html" mimetype="text/html" >
   <Templates section="PROPERTY" prefix="PROPERTY_">
     <Many file="property_html_many.tpl" />
   </Templates>
   <Method name="GET"/>
</Representation>
```
Example HTML code from property\_html\_many.tpl file.
In example bellow section starts and ends with section name PROPERTY. **Autogenerated\_SDF\_ID** and **RPROPAD** property are rendered in table columns named
**ID** and **Address**. In column **Property Report** link is created to item HTML with id(primary key value). Using item primary key value returns query with "Single" result. How to define template file for query with "Single" result look bellow at **Single element** configuration.
```

<table class="border">
      <thead>
        <tr>
          <th>ID</th>
          <th>Address</th>
          <th>Property Report</th>
        </tr>
      </thead>
      <tbody>
    {{#PROPERTY}}
        <tr>
          <td>{{PROPERTY_Autogenerated_SDF_ID}}</td>
          <td>{{PROPERTY_RPROPAD}}</td>
          <td><a title="Property Report for {{PROPERTY_RPROPAD}}" href="/georest/rest/data/property/{{PROPERTY_Autogenerated_SDF_ID}}.html">Property Report</a></td>
        </tr>
    {{/PROPERTY}}
      </tbody>
    </table>

```

Get property resource as HTML document using property\_html\_many.tpl file:
```
georest.org/georest/rest/data/property/.html
```


> #### Single element ####
**Single  element** defines the name of the file used for "queries" with single results. The filename is defined with the **file attribute** of the the **Single element**.
Examples:
    * Single element configuration in restcfg.xml.
```
<Representation renderer="Template" pattern=".html" mimetype="text/html" >
   <Templates section="PROPERTY" prefix="PROPERTY_">
     <Many file="property_html_many.tpl" />
     <Single file="property_html_single.tpl" />
   </Templates>
   <Method name="GET"/>
</Representation>
```

Example HTML code from property\_html\_single.tpl file.

In example bellow section starts and ends with section name PROPERTY. **RPROPAD** property is rendered in HTML table row with "Address" label.
At Location row center ordinates X and Y are rendered using geometry property suffix. More about suffix read at [Geometry Property suffix](RenderersTemplate#Geometry_Property_suffix.md)

```
{{#PROPERTY}}
<table class="border">
        <thead>
          <tr>
            <th colspan="2">General Information</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Address:</td>
            <td>
              <div class="adr">
                <span class="street-address">{{PROPERTY_RPROPAD}}</span>
              </div>
             </td>
          </tr>
           <tr>
            <td>Location</td>
            <td>
              <div class="geo">
                <span class="latitude">{{PROPERTY_SHPGEOM_CENTROID_Y}}</span>,
                <span class="longitude">{{PROPERTY_SHPGEOM_CENTROID_X}}</span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
{{/PROPERTY}}
```

In the example bellow property\_html\_single.tpl file will be used for generating HTML document for property with ID column (Autogenerated\_SDF\_ID) of value 1.
Get property resource as HTML document using property\_html\_single.tpl file:
```
georest.org/georest/rest/data/property/1.html
```

> #### None element ####
In the **None element** the file is defined to be used for "query" which do not return any result. The filename is defined with the file attribute of the the **None element**.

Examples:
```
<Representation renderer="Template" pattern=".html" mimetype="text/html" >
   <Templates section="PROPERTY" prefix="PROPERTY_">
     <Many file="property_html_many.tpl" />
     <Single file="property_html_single.tpl" />
     <None file="property_html_none.tpl" />
   </Templates>
   <Method name="GET"/>
</Representation>
```

Example HTML code from property\_html\_none.tpl file.
```
  <div>
    <p>Sorry, no results were found for your query.</p>
  </div>
```
> #### Error element ####
**Error element** defines the file to be used for "query" which return an error or exception as result. The filename is defined with the file attribute of the the **Error element**.

Example:
```
<Representation renderer="Template" pattern=".html" mimetype="text/html" >
   <Templates section="PROPERTY" prefix="PROPERTY_">
     <Many file="property_html_many.tpl" />
     <Single file="property_html_single.tpl" />
     <None file="property_html_none.tpl" />
     <Error file="property_html_error.tpl" />
   </Templates>
   <Method name="GET"/>
</Representation>
```

Example HTML code from property\_html\_error.tpl file.

```
  <div id="georest-content" class="georest-white">
    <p>Sorry, an error has occured during your query.</p>
  </div>
```




> #### AdditionalData element ####

An **AdditionalData** element defines an additional "data source" to be used in the **Templates** element. This additional data are fetched in the template file.

  * AdditionalData element syntax:
```
    <Templates section="<section name>" prefix="<prefix name>">
      <AdditionalData resource="<URI to additional data Resource>" section="<additional data section name>" rowsection="<additional data row section name>" prefix="additional data prefix name" >
      </AdditionalData>
      ....
    </Templates>
```
    * resource attribute: georest URI to additional data **Resource**.
    * section attribute: defines the section name in template file to fetch the additional data
    * rowsection attribute: defines the name of row section in template file
    * prefix attribute: the **attribute prefix** defines the property prefix for the additional data in the template file

**Section** and **prefix** attribute also configure section and prefix name as the **Section** and **prefix** attributes of the **Templates** element.

In the example bellow use of the **AdditionalData** element is shown. **Resource** attribute value is set to `http://localhost/georest/rest/data/building/.xml?BBOX={{#PROPERTY}}{{PROPERTY_SHPGEOM_BBOX}}{{/PROPERTY}}`. This URI defines that in the template file for the property resource additional data from building resource will be used. From URI we can see that each property can get additional data from building resource if this building lies inside the bounding box of the property geometry. This is done by using URI parameter BBOX and set the value of the parameter to the value of the property geometry bounding box. More about parameters read at [URI parameters](ApiUriParams.md) and more about how to get geometry bounding box at [Property name suffix](RenderersTemplate#Property_name_suffix.md).
> Section attribute value is set to "BUILDING", **rowsection** attribute value is "BUILDING\_ROW" and **prefix** value is "BUILDING_".
> Example:
```
     <Templates section="PROPERTY" prefix="PROPERTY_">
        <Many file="property_html_many.tpl" />
        <Single file="property_html_single.tpl" />
        <None file="property_html_none.tpl" />
        <Error file="property_html_error.tpl" />
        <AdditionalData resource="http://localhost/georest/rest/data/building/.xml?BBOX={{#PROPERTY}}{{PROPERTY_SHPGEOM_BBOX}}{{/PROPERTY}}" section="BUILDING" rowsection="BUILDING_ROW" prefix="BUILDING_" >
        </AdditionalData>
    </Templates>
```_


> Example of using **AdditionalData** in the template file:
> Under the property bounding box a list off building names is added.
```
   {{#PROPERTY}}
   <tr>
    <td>Geometry Envelope</td>
    <td>
      <div >
        <span >{{PROPERTY_SHPGEOM_BBOX}}</span>
      </div>
    </td>
    </tr>
    <tr>
    <td>Building names:</td>
    <td>
       {{#BUILDING}}
       {{#BUILDING_ROW}}
        {{BUILDING_NAME}}
       {{/BUILDING_ROW}}
       {{/BUILDING}}
    </td>
    </tr>
   {{/PROPERTY}}  
```


### Next and Previous page section ###
  * **NEXT\_PAGE\_SECTION** it is used to define part in template file to be used for **NEXT\_PAGE** option. **NEXT\_PAGE** options creates a string value for HTML href link to browse to next query results.

  * **PREVIOUS\_PAGE\_SECTION** it is used to define part in template file to be used for **PREVIOUS\_PAGE** option. **PREVIOUS\_PAGE** options creates a string value for HTML href link to browse to previous query results.
GeoREST creates link by using **COUNT** and **START** parameters in the link. Read [URI Parameters](ApiUriParams.md) configuration.

```
{{#NEXT_PAGE_SECTION}}
  <a href="{{NEXT_PAGE}}">Next</a>
{{/NEXT_PAGE_SECTION}}
{{#PREVIOUS_PAGE_SECTION}}
  <a href="{{PREVIOUS_PAGE}}">Previous</a>
{{/PREVIOUS_PAGE_SECTION}}

```